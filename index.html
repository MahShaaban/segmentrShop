<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>segmentrShop • segmentrShop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="segmentrShop">
<meta property="og:description" content="Chromatin segmentation analysis transforms ChIP-seq data into 
    signals over the genome.  The latter represents the observed states in a 
    multivariate Markov model to predict the underlying (hidden) states of the
    chromatin. ChromHMM, written in Java, integrates histone modification 
    datasets to learn the chromatin states de-novo. We developed an R package 
    around this program to leverage the existing R/Bioconductor tools and data
    structures in the context of the segmentation analysis. segmentr wraps the 
    Java modules to call ChromHMM and captures the output in an S3 R object. 
    This allows for iterating with different parameters, which are given in R 
    syntax. Capturing the output in R makes it easier to work with the results 
    and to integrate them in downstream analyses. Finally, segmentr provides 
    additional tools to test, select and visualize the models. To sum, we 
    developed an R package to wrap a popular chromatin segmentation tool and 
    capture the output in R for testing and visualization. In this demo, a 
    brief introduction of semgnetation analysis and ChromHMM in particlare 
    will be given. Then we will use the segmentr packaged to apply the 
    analysis to a test dataset and explore the output. We will focus on 
    iterating over models with diffferent numbers of to select one the fits 
    the data well and visualizing the results">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">segmentrShop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/syllabus.html">Syllabus: Chromatin segmentation analysis in R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MahShaaban/segmentrShop">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><img src="https://github.com/MahShaaban/segmentrShop/workflows/.github/workflows/basic_checks.yaml/badge.svg" alt=".github/workflows/basic_checks.yaml"></p>
<div id="software-demo-chromatin-segmentation-analysis-in-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#software-demo-chromatin-segmentation-analysis-in-r" class="anchor"></a>Software Demo: Chromatin segmentation analysis in R</h1></div>
<div id="description" class="section level2">
<h2 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h2>
<p>Chromatin segmentation analysis transforms ChIP-seq data into signals over the genome. The latter represents the observed states in a multivariate Markov model to predict the underlying (hidden) states of the chromatin. ChromHMM, written in Java, integrates histone modification datasets to learn the chromatin states de-novo. We developed an R package around this program to leverage the existing R/Bioconductor tools and data structures in the context of the segmentation analysis. segmentr wraps the Java modules to call ChromHMM and captures the output in an S3 R object. This allows for iterating with different parameters, which are given in R syntax. Capturing the output in R makes it easier to work with the results and to integrate them in downstream analyses. Finally, segmentr provides additional tools to test, select and visualize the models. To sum, we developed an R package to wrap a popular chromatin segmentation tool and capture the output in R for testing and visualization.</p>
<p>In this demo, a brief introduction of semgnetation analysis and ChromHMM in particlare will be given. Then we will use the segmentr packaged to apply the analysis to a test dataset and explore the output. We will focus on iterating over models with diffferent numbers of to select one the fits the data well and visualizing the results</p>
</div>
<div id="pre-requisites" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-requisites" class="anchor"></a>Pre-requisites</h2>
<ul>
<li>Basic knowledge of <em>R</em> syntax</li>
<li>Familiarity ChIP-seq data</li>
<li>Reading: <a href="https://www.nature.com/articles/nmeth.1906">Ernst &amp; Kellis, 2012</a>
</li>
</ul>
</div>
<div id="participation" class="section level2">
<h2 class="hasAnchor">
<a href="#participation" class="anchor"></a>Participation</h2>
<p>Participants are expected to walk through the code (rmarkdown document). A brief an introduction will be given at the beginning to introduce the package and the discussion will be at the end.</p>
<p>To run the materials locally, use the docker image <a href="https://github.com/MahShaaban/segmentrshop">mahshaaban/segmentrshop</a> and knit the <code>Rmd</code> files in <code>vignettes/</code> from within Rstudio.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> pull mahshaaban/segmentrshop:latest</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-e</span> PASSWORD=<span class="op">&lt;</span>a_password<span class="op">&gt;</span> -p 8787:8787 mahshaaban/segmentrshop:latest</span></code></pre></div>
<p>An RStudio session will be accessible at <a href="https://localhost:8787/">https://localhost:8787/</a> in the browser. The login username is always <code>rstudio</code> and the password is <code>&lt;a_password&gt;</code>.</p>
</div>
<div id="r--bioconductor-packages-used" class="section level2">
<h2 class="hasAnchor">
<a href="#r--bioconductor-packages-used" class="anchor"></a><em>R</em> / <em>Bioconductor</em> packages used</h2>
<ul>
<li>segmentr</li>
</ul>
<p>Data management</p>
<ul>
<li>GenomicRanges</li>
<li>AnnotationDbi</li>
</ul>
<p>Annotation packages</p>
<ul>
<li>TxDb.Hsapiens.UCSC.hg18.knownGene</li>
<li>org.Hs.eg.db</li>
</ul>
<p>Visualization</p>
<ul>
<li>ggplot2</li>
<li>ggbio</li>
</ul>
<p><a href="https://www.notion.so/e72e817485a9465daccd16ff41ab97ee">Time outline</a></p>
</div>
<div id="demo-objectives" class="section level2">
<h2 class="hasAnchor">
<a href="#demo-objectives" class="anchor"></a>Demo objectives</h2>
<p>This demo aims to teach participants how to use perform chromatin segmentation analysis of histone modification data in R. They will use the segmentr package to call ChromHMM and capture the output in an R object. They will also learn to select an appropriate number of states to segment the genome and visualize the results of the selected models. By providing a realistic example, participants would be able to understand the analysis workflow and adapt this code to apply it to their own datasets.</p>
</div>
<div id="learning-goals" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-goals" class="anchor"></a>Learning goals</h2>
<ul>
<li>Use the segmentr package to call ChromHMM</li>
<li>Understand the structure of the resulting S3 object</li>
<li>Iterate over models with different number of states</li>
<li>Compare the models and select an appropriate one</li>
<li>Visualize the genome segments using ggbio</li>
<li>Plug the results of ChromHMM in over-represenation analysis</li>
</ul>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/MahShaaban/segmentrShop/">https://​github.com/​MahShaaban/​segmentrShop/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/MahShaaban/segmentrShop/issues/new/choose">https://​github.com/​MahShaaban/​segmentrShop/​issues/​new/​choose</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mahmoud Ahmed <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4377-6541" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Mahmoud Ahmed.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
